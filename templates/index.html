<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>åˆ©ç›Šåˆ¤å®šãƒ„ãƒ¼ãƒ«ï¼ˆWebç‰ˆï¼‰</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <style>
        body { padding: 30px; font-family: 'Meiryo', sans-serif; }
        .card-img { max-width: 200px; }
        textarea { resize: vertical; }
    </style>
</head>
<body>
    <h1 class="mb-4">ğŸ“¦ åˆ©ç›Šåˆ¤å®šãƒ„ãƒ¼ãƒ«ï¼ˆWebç‰ˆï¼‰</h1>

    <form method="POST">
        <div class="mb-3">
            <label for="urls" class="form-label">ãƒ¡ãƒ«ã‚«ãƒªå•†å“URLï¼ˆè¤‡æ•°å¯ï¼‰</label>
            <textarea name="urls" class="form-control" rows="3" placeholder="https://..."></textarea>
        </div>

        <div class="row mb-3">
            <div class="col">
                <label class="form-label">ãƒ¡ãƒ«ã‚«ãƒªä¾¡æ ¼ï¼ˆå††ï¼‰</label>
                <input type="number" name="cost_price" class="form-control" value="33000">
            </div>
            <div class="col">
                <label class="form-label">eBayè²©å£²ä¾¡æ ¼ï¼ˆUSDï¼‰</label>
                <input type="number" name="usd_price" class="form-control" value="270">
            </div>
        </div>

        <div class="row mb-3">
            <div class="col">
                <label class="form-label">å•†å“ã‚¿ã‚¤ãƒ—</label>
                <select name="item_type" class="form-select">
                    <option value="card">ã‚«ãƒ¼ãƒ‰</option>
                    <option value="small_packet" selected>å°å‹åŒ…è£…ç‰©</option>
                </select>
            </div>
            <div class="col">
                <label class="form-label">é‡é‡ (g)</label>
                <input type="number" name="weight" class="form-control" value="750">
            </div>
            <div class="col d-flex align-items-end">
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="insured" checked>
                    <label class="form-check-label">ä¿é™ºã‚ã‚Š</label>
                </div>
            </div>
        </div>

        <button type="submit" class="btn btn-primary">å•†å“æƒ…å ±å–å¾— & åˆ©ç›Šè¨ˆç®—</button>
    </form>

    <hr>

    {% if info_list %}
        <h2 class="mt-4">ğŸ“ å•†å“æƒ…å ±</h2>
        {% for info in info_list %}
            <div class="card mb-3">
                <div class="card-body">
                    <h5 class="card-title">{{ info.name }} <small class="text-muted">({{ info.translated_name }})</small></h5>
                    <p class="card-text">ä¾¡æ ¼: Â¥{{ info.price }}<br>çŠ¶æ…‹: {{ info.translated_condition }}<br>å–å¾—å…ƒ: {{ info.price_source }}</p>
                    {% if info.image_urls %}
                        <img src="{{ info.image_urls[0] }}" class="card-img" alt="å•†å“ç”»åƒ">
                    {% endif %}
                    <a href="{{ info.source_url }}" target="_blank" class="btn btn-outline-secondary mt-2">ãƒ¡ãƒ«ã‚«ãƒªã§è¦‹ã‚‹</a>
                </div>
            </div>
        {% endfor %}
    {% endif %}

    {% if profit_result %}
        <h2 class="mt-4">ğŸ“ˆ åˆ©ç›Šè¨ˆç®—çµæœ</h2>
        <ul class="list-group">
            <li class="list-group-item">ç‚ºæ›¿ãƒ¬ãƒ¼ãƒˆ: 1 USD = Â¥{{ exchange_rate }}</li>
            <li class="list-group-item">eBayè²©å£²ä¾¡æ ¼: ${{ profit_result.usd_price }} â†’ Â¥{{ profit_result.target_price }}</li>
            <li class="list-group-item">é€æ–™: Â¥{{ profit_result.shipping_cost }}</li>
            <li class="list-group-item">eBayæ‰‹æ•°æ–™ (20%): Â¥{{ profit_result.ebay_fee }}</li>
            <li class="list-group-item">ç·ã‚³ã‚¹ãƒˆ: Â¥{{ profit_result.total_cost }}</li>
            <li class="list-group-item">åˆ©ç›Š: Â¥{{ profit_result.profit }}</li>
            <li class="list-group-item">åˆ©ç›Šç‡: {{ profit_result.profit_rate }}%</li>
            <li class="list-group-item fw-bold text-{{ 'success' if profit_result.is_profitable else 'danger' }}">
                å‡ºå“å¯å¦: {{ 'âœ… å‡ºå“å¯èƒ½' if profit_result.is_profitable else 'âŒ å‡ºå“ä¸å¯' }}
            </li>
        </ul>
    {% endif %}

    {% if error %}
        <div class="alert alert-danger mt-4">{{ error }}</div>
    {% endif %}
</body>
</html>